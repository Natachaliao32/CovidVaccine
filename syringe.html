<html>

<head>
    <title>My first three.js</title>
    <style>
        body {
            margin: 0;
        }

        canvas {
            margin: 0 auto;
        }
    </style>
</head>

<body>
    <script src="js/three.js"></script>
    <script type="module" src="js/OrbitControls.js"></script>

    <script>

        //Initialisation//
        var scene = new THREE.Scene();
        var camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 1, 1000);
        var renderer = new THREE.WebGLRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);
        camera.position.set(0, 0, 400);

        //Création de la lumière

        //Ambiante
        var light = new THREE.AmbientLight(0x888888);
        scene.add(light);

        //Directionelle
        var light = new THREE.DirectionalLight(0xfdfcf0, 1);
        light.position.set(20, 10, 20);
        scene.add(light);

        //Genèse

        //Création geometry and material

        function createCustomCylinder(size, radius, mat, position) {
            var geo = new THREE.CylinderGeometry(radius, radius, size, 10, 1);
            geo.applyMatrix4(new THREE.Matrix4().makeTranslation(0, size / 2, 0));
            var cylinder = new THREE.Mesh(geo, mat);
            cylinder.position.set(position.x, position.y, position.z);
            scene.add(cylinder);
        }

        function createSyringe(size, position) {

            // mat & colors
            var glass = new THREE.MeshLambertMaterial({ color: 0x000000, opacity: 0.4, emissive: 0xbababa, transparent: true });
            // var glass = new THREE.MeshLambertMaterial({ color: 0xffffff, opacity: 1, emissive: 0xffffff});
            var metal = new THREE.MeshLambertMaterial({ color: 0x000000, opacity: 1, emissive: 0x777777 });
            var liquidMat = new THREE.MeshLambertMaterial({ color: 0x000000, opacity: 0.8, emissive: 0x007AA0 });
            var liquidColor = new THREE.Color("#007AA0"); // blue
            
            var padding = 2;
            var radius = 5;

            // needle
            var needlesize = 10;
            var needleradius = 1;
            var needleposition = new THREE.Vector3(position.x, position.y, position.z);
            createCustomCylinder(needlesize, needleradius, metal, needleposition);

            // glass container
            var containersize = size + padding + 20;
            var containeradius = radius + padding;
            var containerposition = new THREE.Vector3(position.x, position.y + needlesize, position.z);
            createCustomCylinder(containersize, containeradius, glass, containerposition);
            
            // syringe body
            var bodyposition = new THREE.Vector3(position.x, position.y + needlesize + padding, position.z);
            createCustomCylinder(size, radius, liquidMat, bodyposition);

            // glass plunger (tube)
            var plungertsize = 5;
            var plungertradius = radius - 2;
            var plungertposition = new THREE.Vector3(position.x, position.y +  needlesize + containersize, position.z);
            createCustomCylinder(plungertsize, plungertradius, glass, plungertposition);

            // glass plunger (extremity)
            var plungeresize = 5;
            var plungereradius = containeradius;
            var plungereposition = new THREE.Vector3(position.x, position.y + needlesize + containersize + plungertsize, position.z);
            createCustomCylinder(plungeresize, plungereradius, glass, plungereposition);
        }
        
        var spacing = 50;
        var position1 = new THREE.Vector3(0, -120, 0);

        createSyringe(210, position1);
        position1.x += spacing;
        createSyringe(100, position1);
        position1.x += spacing;
        createSyringe(10, position1);

        //Orbit Controls
        // var orbit = new THREE.OrbitControls( camera, renderer.domElement );

        //Render loop
        var render = function () {
            renderer.render(scene, camera);
            requestAnimationFrame(render);
        };
        render();

    </script>
</body>

</html>